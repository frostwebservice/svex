import{P as p,r as s,j as i,cj as Ne,d as e,ck as we,at as $e,l as f,k as y,aw as W,q as A,c2 as Se,f as M,bx as xe,D as ne,n as H,B as ie,G as R,R as ee,ci as de,ap as Ie,w as ke,c9 as Ge,c$ as B,F as _,ch as te,db as z,y as Me,a as he,bE as me,b9 as q,c7 as J,s as Te,cL as je,L as Q,o as Ue,p as $,K as pe,m as ue,aG as ae,bm as He,bn as _e,bo as qe,a_ as Je,br as Ye,b8 as Ze,dc as Ve,aZ as Ke,cE as ve,c as Qe,S as Xe}from"./app-15d4d073.js";import{u as Y}from"./use-search-params-94f7ff86.js";import{M as et}from"./mail-composer-d8f3d2fb.js";import{A as oe}from"./Attachment01-0728f0ac.js";import{I as tt}from"./Image01-dcc4d816.js";import{L as at}from"./Link01-d673c002.js";import{F as nt}from"./FaceSmile-ba9919fa.js";import{Q as it}from"./quill-editor-1dbd0ce2.js";import{m as ot,D as X,r as st,L as rt,F as lt,d as ct}from"./mail-afa3750e.js";import{P as Ae}from"./Plus-fcec7a26.js";import{S as ge}from"./Star01-b86e1076.js";import{g as dt}from"./get-initials-d1c6cec7.js";import{u as ht,P as mt}from"./pagination-196ec208.js";import{A as pt}from"./AlertCircle-d305f87c.js";import{S as ut}from"./Send01-b4ae0f60.js";import{T as gt}from"./Trash02-714cc287.js";import{H as ft}from"./Heart-6ef8ff5f.js";import{L as bt}from"./ListSubheader-23038482.js";import"./isEqual-3cd0cdaf.js";import"./index-12bb38a4.js";import"./file-dropzone-e8617254.js";import"./tslib.es6-af7906ce.js";import"./Upload01-04f1a8e6.js";import"./bytes-to-size-706bbf81.js";import"./LastPage-c5e4a6af.js";const yt=ot(()=>({noBorder:{border:"none"}})),xt=`<pre>Dear [Influencer's Name],

I hope this email finds you well.I have been following your work as an influential figure in [your niche], and I am truly impressed by the value you provide to your audience.Your expertise and unique perspective have inspired me.

I am reaching out today because I believe there is a great opportunity for us to collaborate and create something meaningful together.As someone who shares a passion for [your niche], I believe our combined efforts can have a significant impact on our respective audiences.
I have an idea for a collaboration that I believe will be mutually beneficial.Here's a brief overview:
[Provide a concise description of your collaboration idea.Highlight the value it will bring to both your audience and the influencer's audience. Be specific about the type of collaboration, such as a joint blog post, podcast interview, video series, or any other creative concept.]
I truly admire your work and believe that your insights and expertise would greatly enhance the collaboration.Your unique perspective would undoubtedly resonate with our shared audience.

I understand that you are likely approached by numerous individuals, so I want to assure you that I am committed to making this collaboration as seamless and valuable as possible.I am open to discussing any ideas or modifications you may have to ensure it aligns with your goals and values.
If you are interested in exploring this collaboration further, I would be delighted to schedule a call or have a more detailed discussion via email.Please let me know your availability, and I will be happy to accommodate your schedule.
    Thank you for considering this opportunity.I look forward to the possibility of working together and creating something exceptional that will benefit both our audiences.

Warm regards,
    [Your Name][Your Email Address][Your Website or Social Media Handles][Contact Number(Optional)]</pre>`,We=a=>{const{maximize:t=!1,message:n="",onClose:r,onMaximize:c,onMessageChange:o,onMinimize:d,onSubjectChange:m,onToChange:u,open:C=!1,subject:h="",to:x=""}=a;s.useState(!1),yt();const S=s.useCallback(g=>{m==null||m(g.target.value)},[m]),k=s.useCallback(g=>{u==null||u(g.target.value)},[u]);return C?i(Ne,{children:[e(we,{open:t}),i($e,{sx:{bottom:g=>`calc((${g.spacing(20)})/3)`,display:"flex",flexDirection:"column",height:g=>`calc(100% - ${g.spacing(20)})`,width:g=>`calc(100% - ${g.spacing(40)})`,outline:"none",position:"fixed",right:g=>`calc((${g.spacing(40)}) / 2)`,zIndex:1400,overflow:"hidden"},elevation:12,children:[i(f,{sx:{alignItems:"center",display:"flex",px:2,py:1},children:[e(y,{variant:"h6",children:"Default Template"}),e(f,{sx:{flexGrow:1}}),e(W,{onClick:r,children:e(A,{children:e(Se,{})})})]}),i(M,{alignItems:"center",direction:"row",spacing:1,children:[e(y,{sx:{mx:2},children:"To"}),e(xe,{disableUnderline:!0,fullWidth:!0,onChange:k,sx:{pt:.5,borderBottom:1,borderColor:"divider"},value:x})]}),i(M,{alignItems:"center",direction:"row",spacing:1,children:[e(y,{sx:{mx:2},children:"Subject"}),e(xe,{disableUnderline:!0,onChange:S,placeholder:"Input Subject",sx:{pt:.5,borderBottom:1,borderColor:"divider",width:"-webkit-fill-available",fontSize:18},value:" Instagram Influencer for a shopping brand - The Rock"})]}),e(it,{onChange:o,placeholder:"Type your text",sx:{border:"none",flexGrow:1},value:xt}),e(ne,{}),i(M,{alignItems:"center",direction:"row",justifyContent:"space-between",spacing:3,sx:{p:2},children:[i(M,{alignItems:"center",direction:"row",spacing:1,children:[e(H,{title:"Attach image",children:e(W,{size:"small",children:e(A,{children:e(tt,{})})})}),e(H,{title:"Attach file",children:e(W,{size:"small",children:e(A,{children:e(oe,{})})})}),e(W,{children:e(A,{children:e(at,{})})}),e(W,{children:e(A,{children:e(nt,{})})})]}),e("div",{children:e(ie,{variant:"contained",children:"Save Template"})})]})]})]}):null};We.propTypes={maximize:p.bool,message:p.string,onClose:p.func,onMaximize:p.func,onMessageChange:p.func,onMinimize:p.func,onSubjectChange:p.func,onToChange:p.func,open:p.bool,subject:p.string,to:p.string};const Le=a=>{const{attachments:t=[]}=a,n=t.length,r=()=>{let o=de(".download-link").length;for(let d=0;d<o;d++)de(".download-link")[d].click()},c=(o,d=2)=>{if(!Number(o))return"0 Bytes";const m=1024,u=d<0?0:d,C=["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],h=Math.floor(Math.log(o)/Math.log(m));return`${parseFloat((o/Math.pow(m,h)).toFixed(u))} ${C[h]}`};return console.log(t),i(M,{spacing:2,children:[i(y,{variant:"h6",children:[n," Attachments"]}),e(M,{alignItems:"flex-start",direction:"row",spacing:2,flexWrap:"wrap",children:t.map(o=>i(M,{alignItems:"center",direction:"row",spacing:1,sx:{alignItems:"center",cursor:"pointer",display:"flex"},children:[o.type.split("/")[0]=="image"&&e(R,{component:ee,src:"data:image/png;base64,"+o.attachment,href:"data:"+o.type+";base64,"+o.attachment,download:o.name,variant:"rounded"}),o.type.split("/")[0]!="image"&&e(R,{variant:"rounded",sx:{backgroundColor:"primary.light",borderRadius:"50%"},component:ee,href:"data:"+o.type+";base64,"+o.attachment,download:o.name,children:e(oe,{})}),i("div",{children:[e(y,{className:"download-link",noWrap:!0,variant:"subtitle2",component:ee,href:"data:"+o.type+";base64,"+o.attachment,download:o.name,children:o.name}),e(y,{color:"text.secondary",variant:"body2",children:c(o.size)})]})]},o.id))}),e("div",{children:e(ie,{color:"primary",size:"small",onClick:r,children:"Download all"})})]})};Le.propTypes={attachments:p.array};Ie("div")(({theme:a})=>({color:a.palette.text.primary,fontFamily:a.typography.body1.fontFamily,"& > p":{fontSize:14,lineHeight:a.typography.body1.lineHeight,marginBottom:a.spacing(2)}}));const De=a=>{const{message:t=""}=a;return e("div",{dangerouslySetInnerHTML:{__html:t}})};De.propTypes={message:p.string};const vt=a=>{const{from:t,to:n,subject:r,userinfo:c}=a,o=s.useRef(null),[d,m]=s.useState(X.EditorState.createEmpty()),u=d.getCurrentContent();X.convertToRaw(u);const C=Ge(),[h,x]=s.useState(),S=JSON.parse(localStorage.getItem("email")),[k,g]=s.useState(""),[w,v]=s.useState([]),[l,I]=s.useState(new FormData),[E,F]=s.useState(!1),N=B(),se=T=>{Z(T.getCurrentContent()),m(T),x(ct(X.convertToRaw(T.getCurrentContent())))},G=Y().get("label")||"inbox";s.useEffect(()=>{g(h)},[h]),s.useEffect(()=>{k==""&&m(X.EditorState.createEmpty())},[k]);const Z=async T=>{T.getBlockMap().forEach(L=>{L.findEntityRanges(D=>{const P=D.getEntity();return P!==null&&T.getEntity(P).getType()==="IMAGE"},async(D,P)=>{const ce=T.getBlockForKey(L.getKey()).getEntityAt(D),j=T.getEntity(ce).getData();if(w.includes(j.src))return;let O=w;O.push(j.src),v(O),j.src.includes("blob:http")&&axios({method:"get",url:j.src,responseType:"blob"}).then(function(K){var U=new FileReader;U.readAsDataURL(K.data),U.onloadend=function(){var fe=U.result;axios.post("/api/upload_inline",{uri:j.src.split("/")[3],data:fe}).then(be=>{let ye=w;ye.push(j.src+"."+be.data),v(ye)}).catch(be=>{})}})})})},re=T=>{const L={file:T,localsrc:URL.createObjectURL(T)};return new Promise((D,P)=>{D({data:{link:L.localsrc}})})},le=T=>{I(T)},V=()=>{if(c.is_admin!="1"){if(c.paid=="1"&&c.message_cnt>=50){te.error(`You are trying to send 51th message this month.
 Please upgrade your membership. 
 `+c.time+"days left by renewal date.");return}else if(c.paid=="0"&&c.message_cnt>=5){te.error(`Trial user cannot send over 5 messages .
 Please upgrade your membership.`);return}}if(F(!0),G=="inbox")l.append("to",t.email);else{let T="";n[0].name.map((L,D)=>{T+=D==n[0].name.length-1?L.mail:L.mail+", "}),l.append("to",T)}l.append("subject",r),l.append("message",k),l.append("email",S),l.append("inlineImgs",w),axios.post("/api/send_mail",l,{}).then(T=>{te.success("Message Sent Successfuly."),N(z.getEmails({label:G,email:JSON.parse(localStorage.getItem("email"))})),N(Me({email:JSON.parse(localStorage.getItem("email"))})),F(!1),g(""),v([]),I(new FormData)}).catch(T=>{})};return de(".rdw-remove-wrapper").on("click",function(){C.handleOpen()}),i(_,{children:[e(f,{sx:{p:3},...a,children:e(M,{alignItems:"flex-start",direction:"row",spacing:2,children:i(f,{sx:{flexGrow:1},children:[e(st.Editor,{editorState:d,wrapperClassName:"wrapper-class reply-wrapper",editorClassName:"editor-class reply-class",toolbarClassName:"toolbar-class",onEditorStateChange:se,toolbar:{options:["image","link","emoji","remove"],link:{options:["link"],link:{icon:"/assets/icons/link.png"}},emoji:{icon:"/assets/icons/smile.png"},image:{icon:"/assets/icons/image.png",uploadCallback:re,previewImage:!0},remove:{icon:"/assets/icons/attach.png",title:"Attach"}}}),i(M,{alignItems:"center",direction:"row",justifyContent:"space-between",spacing:3,sx:{p:2,mb:2},children:[e(M,{alignItems:"center",direction:"row",spacing:1,sx:{ml:17}}),e("div",{children:e(rt,{loading:E,loadingPosition:"center",variant:"contained",onClick:V,children:"Reply"})})]}),e(lt,{onClose:C.handleClose,open:C.open,onUpgrade:le})]})})}),e("input",{hidden:!0,ref:o,type:"file"})]})},Ct=a=>({userinfo:a.profile.userinfo}),wt=ke(Ct)(vt),Ee=a=>{const{backHref:t,uid:n,createdAt:r,from:c,to:o,folder:d="inbox",onSidebarToggle:m,currentLabelId:u="inbox"}=a,C=he(),h=me(v=>v.breakpoints.up("md")),x=q(new Date(r),"MMMM d yyyy, h:mm:ss a"),[S,k]=s.useState(!1),g=J(v=>v.mail.labels),w=v=>{k(!0),axios.post("/api/del_mail",{uid:v,label:d,email:JSON.parse(localStorage.getItem("email"))}).then(l=>{k(!1),u=="inbox"&&C.push("/dashboard/mail"),u=="sent"&&C.push("/dashboard/mail?label=sent"),u=="favorites"&&C.push("/dashboard/mail?label=favorites")}).catch(l=>{})};return i("div",{children:[i(M,{alignItems:"center",direction:"row",justifyContent:"space-between",spacing:2,sx:{p:2},children:[S==!0?i(f,{sx:{display:"flex",textAlign:"center"},children:[e(Te,{}),e(y,{sx:{display:"inline",fontSize:18,fontWeight:700,p:1},children:"Removing..."})]}):e(_,{}),i("div",{children:[e(W,{onClick:m,children:e(A,{children:e(je,{})})}),e(y,{sx:{display:"inline",fontSize:18,fontWeight:700},children:u==null?"Inbox":g.map(v=>{if(v.id==u)return v.name})})]})]}),e(ne,{}),i(M,{alignItems:"center",direction:"row",justifyContent:"space-between",spacing:2,sx:{p:3},children:[d=="inbox"?i(M,{alignItems:"center",direction:"row",spacing:2,children:[e(R,{src:`https://ui-avatars.com/api/?name=${c.email}&background=2970FF&color=fff&rounded=true`}),i("div",{children:[e(y,{component:"span",variant:"subtitle2",children:c.name})," ",e(Q,{color:"text.secondary",component:"span",variant:"body2",children:c.email}),i(y,{color:"text.secondary",variant:"subtitle2",children:["To:"," ",o.map(v=>e(Q,{color:"inherit",children:v.email},v.email))]})]})]}):i(M,{alignItems:"center",direction:"row",spacing:2,children:[e(R,{src:`https://ui-avatars.com/api/?name=${c.email}&background=2970FF&color=fff&rounded=true`}),i("div",{children:[e(y,{component:"span",variant:"subtitle2",children:c.name})," ",e(Q,{color:"text.secondary",component:"span",variant:"body2",children:c.email}),i(y,{color:"text.secondary",variant:"subtitle2",children:["To:"," ",o[0].name.map((v,l)=>e(Q,{color:"inherit",children:l==o[0].name.length-1?v.mail:v.mail+", "},v.mail))]})]})]}),e(M,{alignItems:"center",direction:"row",spacing:1,children:h&&i(_,{children:[x&&e(y,{color:"text.secondary",noWrap:!0,variant:"caption",children:x}),e(H,{title:"Delete",children:e(W,{onClick:()=>w(n),children:e("img",{src:"/assets/icons/trash.png",width:15,height:15})})})]})})]})]})};Ee.propTypes={backHref:p.string.isRequired,from:p.object.isRequired,to:p.array.isRequired};const St=a=>(B(),J(n=>n.mail.emails.byId[a])),Pe=a=>{const{emailId:t,currentLabelId:n,onSidebarToggle:r}=a,c=St(t),o=Ue(),d=n&&n!=="inbox"?$.dashboard.mail+`?label=${n}`:$.dashboard.mail;if(!c)return o(d),null;const m=!!c.message,u=c.attachments&&c.attachments.length>0;return i(M,{sx:{flexGrow:1,height:"100%",overflowY:"auto"},children:[e(Ee,{uid:t,backHref:d,createdAt:new Date(c.createdAt),currentLabelId:n,folder:c.realfolder,from:c.from,onSidebarToggle:r,to:c.to}),i(f,{sx:{flexGrow:1,px:3,py:6},children:[e(y,{variant:"h3",children:c.subject}),i(M,{sx:{mt:2},spacing:6,children:[m&&e(De,{message:c.message}),u&&e(Le,{attachments:c.attachments})]})]}),e(wt,{from:c.from,to:c.to,subject:c.subject})]})};Pe.propTypes={emailId:p.string.isRequired,currentLabelId:p.string};const It=Ie("div",{shouldForwardProp:a=>a!=="open"})(({theme:a,open:t})=>({flexGrow:1,overflow:"hidden",[a.breakpoints.up("md")]:{marginLeft:-280},transition:a.transitions.create("margin",{easing:a.transitions.easing.sharp,duration:a.transitions.duration.leavingScreen}),...t&&{[a.breakpoints.up("md")]:{marginLeft:0},transition:a.transitions.create("margin",{easing:a.transitions.easing.easeOut,duration:a.transitions.duration.enteringScreen})}}));var kt=function(t){return e("svg",pe({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none"},t,{children:e("path",{fill:"#fff",fillOpacity:.01,stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 7.8c0-1.6802 0-2.5202.327-3.162a3 3 0 0 1 1.311-1.311C7.2798 3 8.1198 3 9.8 3h4.4c1.6802 0 2.5202 0 3.162.327a2.9997 2.9997 0 0 1 1.311 1.311C19 5.2798 19 6.1198 19 7.8V21l-7-4-7 4V7.8Z"})}))};const Oe=a=>{const{email:t,onDeselect:n,onSelect:r,onCompose:c,selected:o,href:d,...m}=a,u=B(),h=Y().get("label")||void 0,x=s.useCallback(l=>{l.target.checked?r==null||r():n==null||n()},[r,n]),S=q(new Date(t.createdAt),"MMM dd"),k=q(new Date(t.createdAt),"MMM dd, hh:mm aa"),g=!!(t.attachments&&t.attachments.length>0),w=!!(t.attachments&&t.attachments.length>1);he();const v=(l,I,E,F)=>{axios.post("/api/update_fav",{uid:I,flag:l,email:JSON.parse(localStorage.getItem("email")),label:E}).then(N=>{u(z.getEmails({label:F,email:JSON.parse(localStorage.getItem("email"))}))}).catch(N=>{})};return i(f,{sx:{alignItems:"center",borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:"divider",display:"flex",p:2,...!t.isUnread&&{position:"relative","&:before":{backgroundColor:"primary.main",content:'" "',height:"100%",left:0,position:"absolute",top:0,width:4},"& $name, & $subject":{fontWeight:600}},...o&&{backgroundColor:"primary.lightest"},...!o&&{"&:hover":{backgroundColor:"action.hover"}}},...m,children:[i(f,{sx:{alignItems:"center",display:{md:"flex",xs:"none"},mr:1},children:[e(ue,{checked:o,onChange:x}),e(H,{title:"Starred",children:e(W,{onClick:()=>v(t.favorite,t.id,t.realfolder,t.folder),children:e(A,{sx:{...t.favorite&&{color:"warning.main","& path":{fill:l=>l.palette.warning.main,fillOpacity:1}}},children:e(ge,{})})})})]}),i(f,{component:ee,href:d,sx:{alignItems:"center",cursor:"pointer",display:"contents",flexGrow:1,flexWrap:{xs:"wrap",md:"wrap"},minWidth:1,textDecoration:"none"},children:[t.realfolder=="inbox"?i(f,{sx:{alignItems:"center",display:"flex"},children:[e(R,{src:`https://ui-avatars.com/api/?name=${t.from.email}&background=2970FF&color=fff&rounded=true`}),e(y,{color:"text.primary",sx:{width:120,ml:2,...!t.isUnread&&{fontWeight:600}},noWrap:!0,variant:"body2",children:t.from.email})]}):i(f,{sx:{alignItems:"center",display:"flex"},children:[e(R,{src:`https://ui-avatars.com/api/?name=${t.to[0].name[0].mail}&background=2970FF&color=fff&rounded=true`}),e(y,{color:"text.primary",sx:{width:120,ml:2,...!t.isUnread&&{fontWeight:600}},noWrap:!0,variant:"body2",children:t.to[0].name.map(l=>l.mail)})]}),i(f,{sx:{ml:{xs:0,md:2},my:{xs:2,md:0},overflow:"hidden",width:"-webkit-fill-available"},children:[i(f,{sx:{alignItems:"center",display:"flex",maxWidth:800,width:"100%"},children:[t.isUnread.seen=="Seen"?e(y,{color:"text.primary",sx:{fontWeight:400,minWidth:100,maxWidth:400,mr:1},noWrap:!0,variant:"body2",children:t.subject}):e(y,{color:"text.primary",sx:{fontWeight:700,minWidth:100,maxWidth:400,mr:1},noWrap:!0,variant:"body2",children:t.subject}),e(y,{className:"inline-item",color:"text.secondary",noWrap:!0,variant:"body2",children:e("div",{dangerouslySetInnerHTML:{__html:t.message}})})]}),g&&i(f,{sx:{mt:1,maxWidth:800},children:[e(ae,{icon:e(A,{children:e(oe,{})}),label:t.attachments[0].name,size:"small"}),w&&e(ae,{label:"+"+(t.attachments.length-1).toString(),size:"small",sx:{ml:1}})]})]}),e(f,{sx:{margin:"auto"},children:e(y,{color:"text.secondary",variant:"caption",alignItems:"center",sx:{display:"block",textAlign:{xs:"left",md:"right"},whiteSpace:"nowrap",width:"100%"},children:h&&h.search("template")>=0?"Last used-"+k:S})})]})]})};Oe.propTypes={email:p.object.isRequired,href:p.string.isRequired,onDeselect:p.func,onSelect:p.func,selected:p.bool.isRequired};const Re=a=>{const{email:t,onDeselect:n,onSelect:r,onCompose:c,selected:o,href:d,...m}=a,C=Y().get("label")||void 0,h=s.useCallback(w=>{w.target.checked?r==null||r():n==null||n()},[r,n]),x=q(new Date(t.createdAt),"MMM dd"),S=q(new Date(t.createdAt),"MMM dd, hh:mm aa"),k=!!(t.attachments&&t.attachments.length>0),g=!!(t.attachments&&t.attachments.length>1);return i(f,{sx:{alignItems:"center",borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:"divider",display:"flex",p:2,...!t.isUnread&&{position:"relative","&:before":{backgroundColor:"primary.main",content:'" "',height:"100%",left:0,position:"absolute",top:0,width:4},"& $name, & $subject":{fontWeight:600}},...o&&{backgroundColor:"primary.lightest"},...!o&&{"&:hover":{backgroundColor:"action.hover"}}},...m,children:[i(f,{sx:{alignItems:"center",display:{md:"flex",xs:"none"},mr:1},children:[e(ue,{checked:o,onChange:h}),e(H,{title:"Starred",children:e(W,{children:e(A,{sx:{...t.isStarred&&{color:"warning.main","& path":{fill:w=>w.palette.warning.main,fillOpacity:1}}},children:e(ge,{})})})})]}),i(f,{sx:{alignItems:"center",cursor:"pointer",display:"flex",flexGrow:1,flexWrap:{xs:"wrap",md:"wrap"},minWidth:1,textDecoration:"none"},children:[i(f,{sx:{alignItems:"center",display:"flex"},children:[e(R,{src:t.from.avatar||void 0,children:dt(t.from.name)}),e(y,{color:"text.primary",sx:{width:120,ml:2,...!t.isUnread&&{fontWeight:600}},noWrap:!0,variant:"body2",children:t.from.name})]}),i(f,{sx:{ml:{xs:0,md:2},my:{xs:2,md:0},overflow:"hidden",width:"fit-content"},children:[i(f,{sx:{alignItems:"center",display:"flex",maxWidth:800,width:"100%"},children:[e(y,{color:"text.primary",sx:{fontWeight:600,minWidth:100,maxWidth:400,mr:1},noWrap:!0,variant:"body2",children:t.subject}),i(y,{color:"text.secondary",noWrap:!0,variant:"body2",children:["—",t.message]})]}),k&&i(f,{sx:{mt:1,maxWidth:800},children:[e(ae,{icon:e(A,{children:e(oe,{})}),label:t.attachments[0].name,size:"small"}),g&&e(ae,{label:"+1",size:"small",sx:{ml:1}})]})]}),e(f,{children:e(y,{color:"text.secondary",variant:"caption",alignItems:"center",sx:{display:"block",textAlign:{xs:"left",md:"right"},whiteSpace:"nowrap",width:"100%"},children:C&&C.search("template")>=0?"Last used-"+S:x})})]})]})};Re.propTypes={email:p.object.isRequired,href:p.string.isRequired,onDeselect:p.func,onSelect:p.func,selected:p.bool.isRequired};const Mt=a=>{const t=B(),{emails:n}=J(r=>r.mail);return s.useEffect(()=>{t(z.getEmails({label:a??"inbox",email:JSON.parse(localStorage.getItem("email"))}))},[a]),n},Tt=a=>{const[t,n]=s.useState([]);s.useEffect(()=>{n([])},[a]);const r=s.useCallback(()=>{n([...a])},[a]),c=s.useCallback(m=>{n(u=>u.includes(m)?u:[...u,m])},[]),o=s.useCallback(()=>{n([])},[]),d=s.useCallback(m=>{n(u=>u.filter(C=>C!==m))},[]);return{handleDeselectAll:o,handleDeselectOne:d,handleSelectAll:r,handleSelectOne:c,selected:t}},ze=a=>{const{currentLabelId:t,disCount:n,onSidebarToggle:r,onCompose:c,...o}=a,d=Mt(t),[m,u]=s.useState(!0),C=B(),h=J(b=>b.mail.labels),[x,S]=s.useState(0);s.useState([]),s.useState([]),s.useEffect(()=>{S(1),u(!0)},[t]);const{handleDeselectAll:k,handleDeselectOne:g,handleSelectAll:w,handleSelectOne:v,selected:l}=Tt(d.allIds),I=s.useCallback(b=>{b.target.checked?w():k()},[w,k]),E=b=>{b.isUnread.seen||axios.post("/api/unread_set",{uid:b.id,email:JSON.parse(localStorage.getItem("email"))}).then(j=>{C(z.getEmails({label:"inbox",email:JSON.parse(localStorage.getItem("email"))})),C(z.getCntEmails({label:"inbox",email:JSON.parse(localStorage.getItem("email"))}))}).catch(j=>{})},F=l.length===d.allIds.length,N=l.length>0&&l.length<d.allIds.length,se=d.allIds.length>0,[G,Z]=s.useState(d.allIds);s.useEffect(()=>{x==1&&u(!1),S(x+1),x>=2&&S(0),Z(d.allIds)},[d]);const[re,le]=s.useState(1),V=10,T=Math.ceil(G.length/V),L=ht(G,V),D=(b,j)=>{le(j),L.jump(j)},P=s.useRef(null),ce=s.useCallback(b=>{var K;b.preventDefault();const j=((K=P.current)==null?void 0:K.value)||"";let O=d.allIds.filter(U=>!(typeof j<"u"&&j!==""&&!(d.byId[U].subject||"").toLowerCase().includes(j.toLowerCase())));Z(O)},[d]);return i(M,{sx:{height:"100%",overflowY:"auto"},...o,children:[e(M,{alignItems:"center",direction:"row",justifyContent:"space-between",spacing:2,sx:{p:2},children:i("div",{children:[e(W,{onClick:r,children:e(A,{children:e(je,{})})}),e(y,{sx:{display:"inline",fontSize:18,fontWeight:700},children:t==null?"Inbox":h.map(b=>{if(b.id==t)return b.name})})]})}),e(ne,{}),m==!0?i(we,{open:m,onClick:b=>b.preventDefault(),sx:{color:"#fff",zIndex:b=>b.zIndex.drawer+1},children:[e(Te,{color:"inherit"}),e(y,{sx:{display:"inline",fontSize:18,fontWeight:700,p:1},children:"Loading..."})]}):se?i(_,{children:[i(f,{sx:{alignItems:"center",borderBottomColor:"divider",borderBottomStyle:"solid",borderBottomWidth:1,display:{xs:"none",md:"flex"},p:2},children:[e(ue,{checked:F,indeterminate:N,onChange:I}),e(y,{variant:"subtitle2",children:"Select all"}),e(f,{sx:{flexGrow:1}}),i(M,{alignItems:"center",direction:"row",spacing:1,children:[t&&t.search("template")>=0?e(ie,{onClick:c,startIcon:e(A,{children:e(Ae,{})}),variant:"contained",children:"New Template"}):"",e(f,{component:"form",onSubmit:ce,sx:{flexGrow:1},children:e(He,{fullWidth:!0,inputProps:{ref:P},placeholder:"Search email",size:"small",startAdornment:e(_e,{position:"start",children:e(A,{children:e(qe,{})})}),sx:{width:200}})}),e(mt,{count:T,page:re,variant:"outlined",shape:"rounded",onChange:D})]})]}),e("div",{children:L.currentData().map(b=>{const j=l.includes(b),O=t&&t!=="inbox"?$.dashboard.mail+`?emailId=${b}&label=${t}`:$.dashboard.mail+`?emailId=${b}`;return t&&t.search("template")>=0?e(Re,{email:d.byId[b],href:O,onCompose:c,onClick:c,onDeselect:()=>g(b),onSelect:()=>v(b),selected:j},b):d.byId[b]&&e(Oe,{email:d.byId[b],href:O,onClick:()=>E(d.byId[b]),onCompose:c,onDeselect:()=>g(b),onSelect:()=>v(b),selected:j},b)})})]}):i(M,{alignItems:"center",justifyContent:"center",spacing:2,sx:{flexGrow:1,p:2},children:[e(f,{component:"img",src:"/assets/errors/error-404.png",sx:{height:"auto",maxWidth:120}}),e(y,{color:"text.secondary",variant:"h5",children:"There are no emails"})]})]})};ze.propTypes={currentLabelId:p.string,onSidebarToggle:p.func};var jt=function(t){return i("svg",pe({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none"},t,{children:[e("path",{fill:"#fff",fillOpacity:.01,d:"M14.7301 4H9.2699c-.9692 0-1.4538 0-1.8816.1476a2.7 2.7 0 0 0-1.0088.6235c-.3234.3166-.54.75-.9735 1.617l-1.95 3.8998c-.17.3401-.255.5102-.315.6885a2.6993 2.6993 0 0 0-.115.4866C3 11.6493 3 11.8395 3 12.2198V14.08c0 1.5121 0 2.2682.2943 2.8458.2588.508.6719.9211 1.18 1.1799.5775.2943 1.3336.2943 2.8457.2943h9.36c1.5121 0 2.2682 0 2.8458-.2943a2.6996 2.6996 0 0 0 1.1799-1.1799C21 16.3482 21 15.5921 21 14.08v-1.8602c0-.3803 0-.5705-.0261-.7568a2.6918 2.6918 0 0 0-.1149-.4866c-.0599-.1783-.145-.3484-.3151-.6885L18.594 6.388c-.4334-.8668-.6501-1.3003-.9735-1.617a2.7 2.7 0 0 0-1.0088-.6234C16.1839 4 15.6993 4 14.7301 4Z"}),e("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.45 11.2h3.0438a1.628 1.628 0 0 1 1.4562.9c.2758.5516.8396.9 1.4562.9h5.1876a1.628 1.628 0 0 0 1.4562-.9 1.628 1.628 0 0 1 1.4562-.9H20.55M9.27 4h5.46c.9692 0 1.4538 0 1.8816.1476a2.7 2.7 0 0 1 1.0088.6235c.3234.3166.5401.75.9735 1.617l1.9499 3.8998c.1701.3401.2552.5102.3151.6885.0533.1583.0918.3212.1149.4866.0261.1863.0261.3765.0261.7568V14.08c0 1.5121 0 2.2682-.2943 2.8458a2.6996 2.6996 0 0 1-1.1799 1.1799c-.5776.2943-1.3337.2943-2.8458.2943H7.32c-1.5121 0-2.2682 0-2.8458-.2943a2.6998 2.6998 0 0 1-1.18-1.1799C3 16.3482 3 15.5921 3 14.08v-1.8602c0-.3803 0-.5705.026-.7568a2.6993 2.6993 0 0 1 .115-.4866c.06-.1783.145-.3484.315-.6885l1.95-3.8999c.4334-.8668.6501-1.3003.9735-1.617a2.7 2.7 0 0 1 1.0088-.6234C7.8161 4 8.3007 4 9.2699 4Z"})]}))},At=function(t){return i("svg",pe({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none"},t,{children:[e("path",{fill:"#fff",fillOpacity:.01,d:"M2.9373 11.9373c-.346-.3459-.5189-.5189-.6426-.7207a2.0013 2.0013 0 0 1-.2394-.5781C2 10.4083 2 10.1637 2 9.6745V5.2c0-1.1201 0-1.6802.218-2.108a2 2 0 0 1 .874-.874C3.5198 2 4.08 2 5.2 2h4.4745c.4892 0 .7338 0 .964.0553.204.049.3991.1298.5781.2394.2018.1237.3748.2966.7207.6426l7.6686 7.6686c1.188 1.188 1.7821 1.7821 2.0046 2.467a2.9996 2.9996 0 0 1 0 1.8541c-.2225.685-.8166 1.2791-2.0046 2.4671l-2.2118 2.2118c-1.188 1.188-1.7821 1.7821-2.4671 2.0046a2.9996 2.9996 0 0 1-1.8541 0c-.6849-.2225-1.279-.8166-2.467-2.0046l-7.6686-7.6686Z"}),e("path",{fill:"#fff",fillOpacity:.01,d:"M8.5 8a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Z"}),e("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 8h.01M2 5.2v4.4745c0 .4892 0 .7338.0553.964.049.204.1298.3991.2394.5781.1237.2018.2966.3748.6426.7207l7.6686 7.6686c1.188 1.188 1.7821 1.7821 2.467 2.0046a2.9996 2.9996 0 0 0 1.8541 0c.685-.2225 1.2791-.8166 2.4671-2.0046l2.2118-2.2118c1.188-1.188 1.7821-1.7821 2.0046-2.4671a2.9996 2.9996 0 0 0 0-1.8541c-.2225-.6849-.8166-1.279-2.0046-2.467l-7.6686-7.6686c-.3459-.346-.5189-.5189-.7207-.6426a2.0013 2.0013 0 0 0-.5781-.2394C10.4083 2 10.1637 2 9.6745 2H5.2c-1.1201 0-1.6802 0-2.108.218a2 2 0 0 0-.874.874C2 3.5198 2 4.08 2 5.2ZM8.5 8a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Z"})]}))};const Wt={all:e(Ze,{}),inbox:e(jt,{}),sent:e(ut,{}),trash:e(gt,{}),drafts:e(Ve,{}),spam:e(pt,{}),starred:e(ge,{}),important:e(kt,{}),favorites:e(ft,{})},Lt=a=>a.type==="system"?Wt[a.id]:e(At,{}),Dt=a=>a.type==="custom"&&a.color||"inherit",Be=a=>{const{active:t,unread:n,label:r,...c}=a,o=Lt(r),d=Dt(r);return r.unreadCount&&r.unreadCount>0,e(Je,{disableGutters:!0,disablePadding:!0,sx:{"& + &":{mt:1}},...c,children:i(Ye,{sx:{borderRadius:1,color:"text.secondary",flexGrow:1,fontSize:m=>m.typography.button.fontSize,fontWeight:m=>m.typography.button.fontWeight,justifyContent:"flex-start",lineHeight:m=>m.typography.button.lineHeight,py:1,px:2,textAlign:"left","&:hover":{backgroundColor:"action.hover"},...t&&{backgroundColor:"action.selected",color:"text.primary"}},children:[e(A,{sx:{color:d,mr:1},children:o}),e(f,{sx:{flexGrow:1},children:r.name}),n!=0&&r.id=="inbox"&&e(y,{color:"inherit",variant:"subtitle2",children:n})]})})};Be.propTypes={active:p.bool,label:p.object.isRequired,onClick:p.func};const Et=a=>{const t={system:[],template:[],custom:[]};return a.forEach(n=>{n.type==="system"?t.system.push(n):n.type==="template"?t.template.push(n):t.custom.push(n)}),t},Fe=a=>{const{currentLabelId:t="inbox",container:n,labels:r,unread:c,onClose:o,onCompose:d,open:m,...u}=a,C=he(),h=me(g=>g.breakpoints.up("md")),x=s.useCallback(g=>{h||o==null||o();const w=g.id!=="inbox"?$.dashboard.mail+`?label=${g.id}`:$.dashboard.mail;C.push(w)},[C,h,o]),S=Et(r),k=i("div",{children:[i(M,{alignItems:"center",direction:"row",spacing:2,sx:{pt:2,px:2},children:[e(y,{variant:"h5",sx:{flexGrow:1},children:"Mailbox"}),!h&&e(W,{onClick:o,children:e(A,{children:e(Se,{})})})]}),e(f,{sx:{p:2},children:e(ie,{fullWidth:!0,onClick:d,startIcon:e(A,{children:e(Ae,{})}),sx:{mt:2},variant:"contained",children:"Compose"})}),e(f,{sx:{pb:2,px:2},children:Object.keys(S).map(g=>i(s.Fragment,{children:[g==="template"&&e(bt,{disableSticky:!0,children:e(y,{color:"text.secondary",variant:"overline",children:"Templates"})}),e(Ke,{disablePadding:!0,children:S[g].map(w=>{const v=t===w.id;return e(Be,{active:v,unread:c,label:w,onClick:()=>x(w)},w.id)})})]},g))})]});return h?e(ve,{anchor:"left",open:m,PaperProps:{sx:{position:"relative",width:280}},SlideProps:{container:n},variant:"persistent",...u,children:k}):e(ve,{anchor:"left",hideBackdrop:!0,ModalProps:{container:n,sx:{pointerEvents:"none",position:"absolute"}},onClose:o,open:m,PaperProps:{sx:{maxWidth:"100%",width:280,pointerEvents:"auto",position:"absolute"}},SlideProps:{container:n},variant:"temporary",...u,children:k})};Fe.propTypes={container:p.any,currentLabelId:p.string,labels:p.array.isRequired,onClose:p.func,onCompose:p.func,open:p.bool};const Pt=()=>{const a=B(),t=J(r=>r.mail.labels),n=s.useCallback(()=>{a(z.getLabels())},[a]);return s.useEffect(()=>{n()},[]),t},Ce=()=>{const a={isFullScreen:!1,isOpen:!1,message:"",subject:"",inlineImgs:[],to:"",toDisplay:"",loading:!1,data:new FormData},t=B(),[n,r]=s.useState(a),c=Y().get("label")||"inbox",o=s.useCallback(()=>{r(l=>({...l,isOpen:!0}))},[]),d=s.useCallback(()=>{r(a)},[]),m=s.useCallback(()=>{r(l=>({...l,isFullScreen:!0}))},[]),u=s.useCallback(()=>{r(l=>({...l,isFullScreen:!1}))},[]),C=s.useCallback(l=>{r(I=>({...I,data:l}))},[]),h=s.useCallback(l=>{r(I=>({...I,message:l}))},[]),x=s.useCallback(l=>{let I=n.inlineImgs;I.includes(l)||(I.push(l),r(E=>({...E,inlineImgs:I})))},[]),S=s.useCallback(()=>{r(l=>({...l,inlineImgs:[]}))},[]),k=s.useCallback(l=>{r(I=>({...I,subject:l}))},[]),g=s.useCallback(l=>{r(I=>({...I,to:l}))},[]),w=s.useCallback(l=>{r(I=>({...I,toDisplay:l}))},[]);return{...n,handleClose:d,handleMaximize:m,handleMessageChange:h,handleMinimize:u,handleInlineImgsChange:x,handleInlineImgsInit:S,handleSubmit:()=>{r(l=>({...l,loading:!0})),n.data.append("to",n.to),n.data.append("subject",n.subject),n.data.append("message",n.message),n.data.append("email",JSON.parse(localStorage.getItem("email"))),n.data.append("inlineImgs",n.inlineImgs),axios.post("/api/send_mail",n.data,{}).then(l=>{te.success("Message Sent Successfuly."),t(z.getEmails({label:c,email:JSON.parse(localStorage.getItem("email"))})),t(Me({email:JSON.parse(localStorage.getItem("email"))})),r(I=>({...I,loading:!1,subject:"",to:"",inlineImgs:[],message:"",isOpen:!1,data:new FormData}))}).catch(l=>{})},handleOpen:o,handleAttach:C,handleSubjectChange:k,handleToChange:g,handleDisplayChange:w}},Ot=()=>{const a=me(d=>d.breakpoints.up("md")),[t,n]=s.useState(a),r=s.useCallback(()=>{n(!!a)},[a]);s.useEffect(()=>{r()},[a]);const c=s.useCallback(()=>{n(d=>!d)},[]),o=s.useCallback(()=>{n(!1)},[]);return{handleToggle:c,handleClose:o,open:t}},Rt=a=>{const{emails:t,cntemails:n}=a;s.useState(!1),s.useEffect(()=>{let l=0;n.allIds.map(I=>{n.byId[I].isUnread.seen||l++}),w(l)},[n]);let r={time:new Date().getTime(),value:"email",expire:3e6},c=JSON.stringify(r);localStorage.setItem("time_token",c);const o=s.useRef(null),d=Y(),m=d.get("emailId"),u=d.get("label")||void 0,C=Pt(),h=Ce(),x=Ce(),S=Ot(),[k,g]=s.useState(0),w=l=>{g(l)};Qe();const v=m?"details":"list";return i(_,{children:[e(Xe,{title:"Dashboard: Mail"}),e(ne,{}),e(f,{component:"main",sx:{backgroundColor:"background.paper",flex:"1 1 auto",overflow:"hidden",position:"relative"},children:i(f,{ref:o,sx:{bottom:0,display:"flex",left:0,position:"absolute",right:0,top:0},children:[e(Fe,{container:o.current,currentLabelId:u,labels:C,unread:k,onClose:S.handleClose,onCompose:h.handleOpen,open:S.open}),i(It,{open:S.open,children:[v==="details"&&e(Pe,{currentLabelId:u,onSidebarToggle:S.handleToggle,emailId:m}),v==="list"&&e(ze,{currentLabelId:u,onSidebarToggle:S.handleToggle,onCompose:x.handleOpen,disCount:w})]})]})}),e(et,{maximize:h.isFullScreen,message:h.message,onClose:h.handleClose,onMessageChange:h.handleMessageChange,onMinimize:h.handleMinimize,onSubjectChange:h.handleSubjectChange,onInlineImgsChange:h.handleInlineImgsChange,onSubmit:h.handleSubmit,onAttach:h.handleAttach,onToChange:h.handleToChange,onDisplayChange:h.handleDisplayChange,handleInlineImgsInit:h.handleInlineImgsInit,inlineImgs:h.inlineImgs,open:h.isOpen,subject:h.subject,loading:h.loading,to:h.to}),e(We,{maximize:x.isFullScreen,message:x.message,onClose:x.handleClose,onMessageChange:x.handleMessageChange,onMinimize:x.handleMinimize,onSubjectChange:x.handleSubjectChange,onToChange:x.handleToChange,open:x.isOpen,subject:x.subject,to:x.to})]})},zt=a=>({emails:a.mail.emails,cntemails:a.mail.cntemails}),ca=ke(zt)(Rt);export{ca as default};
