import{P as i,bF as I,bb as T,b2 as D,j as l,f as b,d as e,k as g,B as S,q as O,aZ as H,T as v,r as d,au as N,b_ as $,l as w,cA as E,an as _,bj as Q,bk as V,D as R,bl as X,bm as Z,bn as J,cj as K,aT as Y,c as ee,F as te,S as re,aM as ne,u as ae}from"./app-7f2c3596.js";import{P as le}from"./Plus-41754be9.js";import{o as se}from"./index-b80aca24.js";import{E as oe}from"./Edit02-9671c5db.js";import{P as ie,a as x}from"./property-list-item-f1530959.js";import{S as M}from"./severity-pill-1ad8861e.js";import{T as B,b as W,c as y,a as G}from"./TableRow-ab2d072d.js";import{T as ce}from"./TableHead-475c5220.js";import{u as de}from"./use-update-effect-6b2ecf6e.js";import{T as ue}from"./TablePagination-e55be398.js";import"./deep-copy-ee95be26.js";import"./apply-pagination-03aa54c3.js";import"./apply-sort-ec30f364.js";import"./LastPage-ceee22b3.js";const pe={canceled:"warning",complete:"success",pending:"info",rejected:"error"},F=r=>{const{onApprove:t,onEdit:s,onReject:n,order:a}=r,o=I(h=>h.breakpoints.up("lg"))?"horizontal":"vertical",u=a.items||[],p=T(a.createdAt,"dd/MM/yyyy HH:mm"),f=pe[a.status],C=D(a.totalAmount).format(`${a.currency}0,0.00`);return l(b,{spacing:6,children:[l(b,{spacing:3,children:[l(b,{alignItems:"center",direction:"row",justifyContent:"space-between",spacing:3,children:[e(g,{variant:"h6",children:"Details"}),e(S,{color:"inherit",onClick:s,size:"small",startIcon:e(O,{children:e(oe,{})}),children:"Edit"})]}),l(ie,{children:[e(x,{align:o,disableGutters:!0,divider:!0,label:"ID",value:a.id}),e(x,{align:o,disableGutters:!0,divider:!0,label:"Number",value:a.number}),l(x,{align:o,disableGutters:!0,divider:!0,label:"Customer",children:[e(g,{color:"text.secondary",variant:"body2",children:a.customer.name}),e(g,{color:"text.secondary",variant:"body2",children:a.customer.address1}),e(g,{color:"text.secondary",variant:"body2",children:a.customer.city}),e(g,{color:"text.secondary",variant:"body2",children:a.customer.country})]}),e(x,{align:o,disableGutters:!0,divider:!0,label:"Date",value:p}),e(x,{align:o,disableGutters:!0,divider:!0,label:"Promotion Code",value:a.promotionCode}),e(x,{align:o,disableGutters:!0,divider:!0,label:"Total Amount",value:C}),e(x,{align:o,disableGutters:!0,divider:!0,label:"Status",children:e(M,{color:f,children:a.status})})]}),l(b,{alignItems:"center",direction:"row",flexWrap:"wrap",justifyContent:"flex-end",spacing:2,children:[e(S,{onClick:t,size:"small",variant:"contained",children:"Approve"}),e(S,{color:"error",onClick:n,size:"small",variant:"outlined",children:"Reject"})]})]}),l(b,{spacing:3,children:[e(g,{variant:"h6",children:"Line items"}),e(H,{children:l(B,{sx:{minWidth:400},children:[e(ce,{children:l(W,{children:[e(y,{children:"Description"}),e(y,{children:"Billing Cycle"}),e(y,{children:"Amount"})]})}),e(G,{children:u.map(h=>{const A=D(h.unitAmount).format(`${h.currency}0,0.00`);return l(W,{children:[l(y,{children:[h.name," ","x"," ",h.quantity]}),e(y,{children:h.billingCycle}),e(y,{children:A})]},h.id)})})]})})]})]})};F.propTypes={onApprove:i.func,onEdit:i.func,onReject:i.func,order:i.object};const he=[{label:"Canceled",value:"canceled"},{label:"Complete",value:"complete"},{label:"Pending",value:"pending"},{label:"Rejected",value:"rejected"}],L=r=>{const{onCancel:t,onSave:s,order:n}=r,a=T(n.createdAt,"dd/MM/yyyy HH:mm");return e(b,{spacing:6,children:l(b,{spacing:3,children:[e(g,{variant:"h6",children:"Details"}),l(b,{spacing:3,children:[e(v,{disabled:!0,fullWidth:!0,label:"ID",name:"id",value:n.id}),e(v,{disabled:!0,fullWidth:!0,label:"Number",name:"number",value:n.number}),e(v,{disabled:!0,fullWidth:!0,label:"Customer name",name:"customer_name",value:n.customer.name}),e(v,{disabled:!0,fullWidth:!0,label:"Date",name:"date",value:a}),e(v,{fullWidth:!0,label:"Address",name:"address",value:n.customer.address1}),e(v,{fullWidth:!0,label:"Country",name:"country",value:n.customer.country}),e(v,{fullWidth:!0,label:"State/Region",name:"state_region",value:n.customer.city}),e(v,{fullWidth:!0,label:"Total Amount",name:"amount",value:n.totalAmount}),e(v,{fullWidth:!0,label:"Status",name:"status",select:!0,SelectProps:{native:!0},value:n.status,children:he.map(c=>e("option",{value:c.value,children:c.label},c.value))})]}),l(b,{alignItems:"center",direction:"row",flexWrap:"wrap",spacing:2,children:[e(S,{color:"primary",onClick:s,size:"small",variant:"contained",children:"Save changes"}),e(S,{color:"inherit",onClick:t,size:"small",children:"Cancel"})]})]})})};L.propTypes={onCancel:i.func,onSave:i.func,order:i.object};const z=r=>{const{container:t,onClose:s,open:n,order:a}=r,[c,o]=d.useState(!1),u=I(h=>h.breakpoints.up("lg")),p=d.useCallback(()=>{o(!0)},[]),f=d.useCallback(()=>{o(!1)},[]);let C=null;return a&&(C=l("div",{children:[l(b,{alignItems:"center",direction:"row",justifyContent:"space-between",sx:{px:3,py:2},children:[e(g,{color:"inherit",variant:"h6",children:a.number}),e(N,{color:"inherit",onClick:s,children:e(O,{children:e($,{})})})]}),e(w,{sx:{px:3,py:4},children:c?e(L,{onCancel:f,onSave:f,order:a}):e(F,{onApprove:s,onEdit:p,onReject:s,order:a})})]})),u?e(E,{anchor:"right",open:n,PaperProps:{sx:{position:"relative",width:500}},SlideProps:{container:t},variant:"persistent",children:C}):e(E,{anchor:"left",hideBackdrop:!0,ModalProps:{container:t,sx:{pointerEvents:"none",position:"absolute"}},onClose:s,open:n,PaperProps:{sx:{maxWidth:"100%",width:400,pointerEvents:"auto",position:"absolute"}},SlideProps:{container:t},variant:"temporary",children:C})};z.propTypes={container:i.any,onClose:i.func,open:i.bool,order:i.object};_("div",{shouldForwardProp:r=>r!=="open"})(({theme:r,open:t})=>({flexGrow:1,overflow:"auto",zIndex:1,[r.breakpoints.up("lg")]:{marginRight:-500},transition:r.transitions.create("margin",{easing:r.transitions.easing.sharp,duration:r.transitions.duration.leavingScreen}),...t&&{[r.breakpoints.up("lg")]:{marginRight:0},transition:r.transitions.create("margin",{easing:r.transitions.easing.easeOut,duration:r.transitions.duration.enteringScreen})}}));const me=[{label:"All",value:"all"},{label:"Canceled",value:"canceled"},{label:"Completed",value:"complete"},{label:"Pending",value:"pending"},{label:"Rejected",value:"rejected"}],ge=[{label:"Newest",value:"desc"},{label:"Oldest",value:"asc"}],q=r=>{const{onFiltersChange:t,onSortChange:s,sortDir:n="asc"}=r,a=d.useRef(null),[c,o]=d.useState("all"),[u,p]=d.useState({query:void 0,status:void 0}),f=d.useCallback(()=>{t==null||t(u)},[u,t]);de(()=>{f()},[u,f]);const C=d.useCallback((m,P)=>{o(P);const k=P==="all"?void 0:P;p(j=>({...j,status:k}))},[]),h=d.useCallback(m=>{var k;m.preventDefault();const P=((k=a.current)==null?void 0:k.value)||"";p(j=>({...j,query:P}))},[]),A=d.useCallback(m=>{const P=m.target.value;s==null||s(P)},[s]);return l("div",{children:[e(Q,{indicatorColor:"primary",onChange:C,scrollButtons:"auto",sx:{px:3},textColor:"primary",value:c,variant:"scrollable",children:me.map(m=>e(V,{label:m.label,value:m.value},m.value))}),e(R,{}),l(b,{alignItems:"center",direction:"row",flexWrap:"wrap",gap:3,sx:{p:3},children:[e(w,{component:"form",onSubmit:h,sx:{flexGrow:1},children:e(X,{defaultValue:"",fullWidth:!0,inputProps:{ref:a},name:"orderNumber",placeholder:"Search by order number",startAdornment:e(Z,{position:"start",children:e(O,{children:e(J,{})})})})}),e(v,{label:"Sort By",name:"sort",onChange:A,select:!0,SelectProps:{native:!0},value:n,children:ge.map(m=>e("option",{value:m.value,children:m.label},m.value))})]})]})};q.propTypes={onFiltersChange:i.func,onSortChange:i.func,sortBy:i.string,sortDir:i.oneOf(["asc","desc"])};const be={complete:"success",pending:"info",canceled:"warning",rejected:"error"},U=r=>{const{count:t=0,items:s=[],onPageChange:n=()=>{},onRowsPerPageChange:a,onSelect:c,page:o=0,rowsPerPage:u=0}=r;return l("div",{children:[e(B,{children:e(G,{children:s.map(p=>{const f=T(p.createdAt,"LLL").toUpperCase(),C=T(p.createdAt,"d"),h=D(p.totalAmount).format(`${p.currency}0,0.00`),A=be[p.status]||"warning";return l(W,{hover:!0,onClick:()=>c==null?void 0:c(p.id),sx:{cursor:"pointer"},children:[l(y,{sx:{alignItems:"center",display:"flex"},children:[l(w,{sx:{backgroundColor:m=>m.palette.mode==="dark"?"neutral.800":"neutral.200",borderRadius:2,maxWidth:"fit-content",ml:3,p:1},children:[e(g,{align:"center",variant:"subtitle2",children:f}),e(g,{align:"center",variant:"h6",children:C})]}),l(w,{sx:{ml:2},children:[e(g,{variant:"subtitle2",children:p.number}),l(g,{color:"text.secondary",variant:"body2",children:["Total of"," ",h]})]})]}),e(y,{align:"right",children:e(M,{color:A,children:p.status})})]},p.id)})})}),e(ue,{component:"div",count:t,onPageChange:n,onRowsPerPageChange:a,page:o,rowsPerPage:u,rowsPerPageOptions:[5,10,25]})]})};U.propTypes={count:i.number,items:i.array,onPageChange:i.func,onRowsPerPageChange:i.func,onSelect:i.func,page:i.number,rowsPerPage:i.number};const ve=()=>{const[r,t]=d.useState({filters:{query:void 0,status:void 0},page:0,rowsPerPage:5,sortBy:"createdAt",sortDir:"desc"}),s=d.useCallback(o=>{t(u=>({...u,filters:o}))},[]),n=d.useCallback(o=>{t(u=>({...u,sortDir:o}))},[]),a=d.useCallback((o,u)=>{t(p=>({...p,page:u}))},[]),c=d.useCallback(o=>{t(u=>({...u,rowsPerPage:parseInt(o.target.value,10)}))},[]);return{handleFiltersChange:s,handleSortChange:n,handlePageChange:a,handleRowsPerPageChange:c,state:r}},fe=r=>{const t=ae(),[s,n]=d.useState({orders:[],ordersCount:0}),a=d.useCallback(async()=>{try{const c=await se.getOrders(r);t()&&n({orders:c.data,ordersCount:c.count})}catch(c){console.error(c)}},[r,t]);return d.useEffect(()=>{a()},[r]),{...s}},Ce=(r,t)=>d.useMemo(()=>{if(t)return r.find(s=>s.id===t)},[r,t]),Ie=()=>{const r=d.useRef(null),t=ve(),s=fe(t.state),n=K(),a=Ce(s.orders,n.data),c=Y();ee();const o=d.useCallback(u=>{if(n.open&&n.data===u){n.handleClose();return}n.handleOpen(u)},[n]);return l(te,{children:[e(re,{title:"Dashboard: Order List"}),e(w,{component:"main",ref:r,sx:{flexGrow:1,py:8},children:e(ne,{maxWidth:c.stretch?!1:"xl",children:e("div",{children:l(w,{ref:r,children:[e(w,{sx:{p:3},children:l(b,{alignItems:"flex-start",direction:"row",justifyContent:"space-between",spacing:4,children:[e("div",{children:e(g,{variant:"h4",children:"Orders"})}),e("div",{children:e(S,{startIcon:e(O,{children:e(le,{})}),variant:"contained",children:"Add"})})]})}),e(R,{}),e(q,{onFiltersChange:t.handleFiltersChange,onSortChange:t.handleSortChange,sortBy:t.state.sortBy,sortDir:t.state.sortDir}),e(R,{}),e(U,{count:s.ordersCount,items:s.orders,onPageChange:t.handlePageChange,onRowsPerPageChange:t.handleRowsPerPageChange,onSelect:o,page:t.state.page,rowsPerPage:t.state.rowsPerPage}),e(z,{container:r.current,onClose:n.handleClose,open:n.open,order:a})]})})})})]})};export{Ie as default};
